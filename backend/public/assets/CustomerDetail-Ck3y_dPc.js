import{p as Z,a as ee,u as se,b as te,r as c,g as T,k as A,n as C,j as e,U as O,q as ie,T as M,C as ae,P as b,h as le,d,R as j,W as z,F as U,S as P,s as ce,e as ne}from"./index-o28qtZ4E.js";import{a as re,b as de,c as m,f}from"./formatters-BhAPqf4o.js";import{P as G}from"./PageWrapper-D4uzFYGf.js";import{B as i,m as l,a as E}from"./proxy-D6mGC7EI.js";import{C as N,M as L}from"./Modal-7Sg338uS.js";import{B as v}from"./Badge-Br48OPWn.js";import{P as oe}from"./phone-B5sqxf62.js";import{M as me}from"./mail-DO_TKUji.js";import{B as xe,I as F}from"./image-CwN3KknU.js";import{M as he}from"./map-pin-CM4a5Gr_.js";import{H as je}from"./history-DPeaAPFW.js";import{C as ue}from"./clock-C6f4WYXs.js";import{A as pe}from"./index-B9GDT2Wk.js";import{P as g}from"./plus-CQNf_PUI.js";import{M as fe}from"./message-square-DD02v1BD.js";import{T as k}from"./trash-2-D5yhdYvO.js";import{D as Ne}from"./download-Bqlh6cxb.js";import{A as ve}from"./arrow-left-Bj3muJoB.js";import{S as ge}from"./square-pen-DhoP9-Gi.js";const be=[{id:"overview",label:"Overview",icon:O},{id:"pledges",label:"Pledges",icon:b},{id:"renewals",label:"Renewals",icon:j},{id:"redemptions",label:"Redemptions",icon:z},{id:"documents",label:"Documents",icon:U}];function Ve(){const{id:x}=Z(),n=ee(),r=se(),{customers:ze}=te(s=>s.customers),[t,V]=c.useState(null),[o,W]=c.useState("overview"),[H,u]=c.useState(!1),[p,y]=c.useState(null),[$,I]=c.useState(!1),[S,D]=c.useState([]),[R,q]=c.useState([]),[B,Y]=c.useState([]);c.useEffect(()=>{const s=T(P.CUSTOMERS,[]);r(A(s));const a=s.find(h=>h.id===x);a&&(V(a),r(C(a)),K(a))},[x,r]);const K=s=>{const a=[{id:"PLG001",date:"2024-12-20",items:"916 Gold Chain (25.5g)",principal:5250,status:"active",dueDate:"2025-06-20"},{id:"PLG002",date:"2024-11-15",items:"916 Gold Bangle (18.2g)",principal:3800,status:"active",dueDate:"2025-05-15"},{id:"PLG003",date:"2024-08-10",items:"999 Gold Ring (8.5g)",principal:2400,status:"redeemed",dueDate:"2025-02-10"}],h=[{id:"REN001",pledgeId:"PLG001",date:"2024-12-01",interest:157.5,method:"Cash"},{id:"REN002",pledgeId:"PLG002",date:"2024-11-30",interest:114,method:"Transfer"}],J=[{id:"RED001",pledgeId:"PLG003",date:"2024-10-15",principal:2400,interest:72,total:2472,method:"Cash"}];s.activePledges>0?D(a.slice(0,s.activePledges+1)):D(a.filter(X=>X.status==="redeemed")),q(h),Y(J)},Q=()=>{I(!0),setTimeout(()=>{const a=T(P.CUSTOMERS,[]).filter(h=>h.id!==x);ce(P.CUSTOMERS,a),r(A(a)),r(ne({type:"success",title:"Customer Deleted",message:`${t.name} has been removed`})),I(!1),u(!1),n("/customers")},500)},_={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},w={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return t?e.jsxs(G,{title:t.name,subtitle:`Customer ID: ${t.id}`,actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{variant:"outline",leftIcon:ve,onClick:()=>n("/customers"),children:"Back"}),e.jsx(i,{variant:"outline",leftIcon:ge,onClick:()=>n(`/customers/${x}/edit`),children:"Edit"}),e.jsx(i,{variant:"danger",leftIcon:k,onClick:()=>u(!0),children:"Delete"}),e.jsx(i,{variant:"accent",leftIcon:g,onClick:()=>{r(C(t)),n("/pledges/new")},children:"New Pledge"})]}),children:[e.jsxs(l.div,{className:"space-y-6",variants:_,initial:"hidden",animate:"visible",children:[e.jsx(l.div,{variants:w,children:e.jsx(N,{children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:t.profilePhoto?e.jsx("img",{src:t.profilePhoto,alt:t.name,className:"w-24 h-24 rounded-2xl object-cover border-4 border-white shadow-lg"}):e.jsx("div",{className:"w-24 h-24 rounded-2xl bg-gradient-to-br from-amber-500 to-amber-600 flex items-center justify-center text-white font-bold text-3xl shadow-lg",children:t.name.charAt(0)})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-zinc-800",children:t.name}),e.jsx("p",{className:"text-zinc-500 font-mono",children:re(t.icNumber)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{variant:"success",size:"lg",children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),"Verified"]}),t.riskLevel==="high"&&e.jsxs(v,{variant:"danger",size:"lg",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"High Risk"]}),t.riskLevel==="medium"&&e.jsx(v,{variant:"warning",size:"lg",children:"Medium Risk"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(oe,{className:"w-4 h-4 text-zinc-400"}),e.jsx("span",{className:"text-zinc-600",children:de(t.phone)})]}),t.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(me,{className:"w-4 h-4 text-zinc-400"}),e.jsx("span",{className:"text-zinc-600",children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ae,{className:"w-4 h-4 text-zinc-400"}),e.jsxs("span",{className:"text-zinc-600",children:["DOB: ",m(t.dateOfBirth)]})]}),t.occupation&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(xe,{className:"w-4 h-4 text-zinc-400"}),e.jsx("span",{className:"text-zinc-600",children:t.occupation})]})]}),e.jsxs("div",{className:"flex items-start gap-2 mt-3 text-sm",children:[e.jsx(he,{className:"w-4 h-4 text-zinc-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-zinc-600",children:t.address})]})]})]})})})}),e.jsx(l.div,{className:"grid grid-cols-2 md:grid-cols-4 gap-4",variants:w,children:[{label:"Active Pledges",value:t.activePledges,icon:b,color:"amber",subtitle:"Currently held"},{label:"Total Pledges",value:t.totalPledges,icon:je,color:"blue",subtitle:"All time"},{label:"Total Value",value:f(t.totalAmount),icon:le,color:"emerald",subtitle:"Portfolio"},{label:"Last Visit",value:m(t.lastVisit),icon:ue,color:"zinc",subtitle:"Recent activity"}].map(s=>e.jsx(l.div,{whileHover:{scale:1.02},transition:{type:"spring",stiffness:300},children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:d("w-10 h-10 rounded-lg flex items-center justify-center",s.color==="amber"&&"bg-amber-100",s.color==="blue"&&"bg-blue-100",s.color==="emerald"&&"bg-emerald-100",s.color==="zinc"&&"bg-zinc-100"),children:e.jsx(s.icon,{className:d("w-5 h-5",s.color==="amber"&&"text-amber-600",s.color==="blue"&&"text-blue-600",s.color==="emerald"&&"text-emerald-600",s.color==="zinc"&&"text-zinc-600")})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-zinc-800",children:s.value}),e.jsx("p",{className:"text-xs text-zinc-500",children:s.label})]})]})})},s.label))}),e.jsx(l.div,{variants:w,children:e.jsxs(N,{children:[e.jsx("div",{className:"border-b border-zinc-100",children:e.jsx("div",{className:"flex overflow-x-auto",children:be.map(s=>e.jsxs("button",{onClick:()=>W(s.id),className:d("flex items-center gap-2 px-5 py-4 text-sm font-medium border-b-2 transition-all whitespace-nowrap",o===s.id?"border-amber-500 text-amber-600 bg-amber-50/50":"border-transparent text-zinc-500 hover:text-zinc-700 hover:bg-zinc-50"),children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label,s.id==="pledges"&&t.activePledges>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-amber-500 text-white rounded-full",children:t.activePledges})]},s.id))})}),e.jsx("div",{className:"p-5",children:e.jsxs(pe,{mode:"wait",children:[o==="overview"&&e.jsxs(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-zinc-800 mb-3",children:"Quick Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",leftIcon:g,onClick:()=>{r(C(t)),n("/pledges/new")},children:"New Pledge"}),e.jsx(i,{variant:"outline",size:"sm",leftIcon:j,children:"Process Renewal"}),e.jsx(i,{variant:"outline",size:"sm",leftIcon:z,children:"Process Redemption"}),e.jsx(i,{variant:"outline",size:"sm",leftIcon:fe,children:"Send WhatsApp"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-zinc-800 mb-3",children:"Recent Activity"}),e.jsx("div",{className:"space-y-3",children:[{action:"Pledge Created",detail:"PLG001 - 916 Gold Chain",date:"2024-12-20",icon:g,color:"emerald"},{action:"Renewal Paid",detail:"PLG001 - RM 157.50 interest",date:"2024-12-01",icon:j,color:"blue"},{action:"Pledge Created",detail:"PLG002 - 916 Gold Bangle",date:"2024-11-15",icon:g,color:"emerald"}].map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-zinc-50 rounded-lg",children:[e.jsx("div",{className:d("w-8 h-8 rounded-full flex items-center justify-center",s.color==="emerald"&&"bg-emerald-100",s.color==="blue"&&"bg-blue-100"),children:e.jsx(s.icon,{className:d("w-4 h-4",s.color==="emerald"&&"text-emerald-600",s.color==="blue"&&"text-blue-600")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-zinc-800",children:s.action}),e.jsx("p",{className:"text-xs text-zinc-500",children:s.detail})]}),e.jsx("span",{className:"text-xs text-zinc-400",children:m(s.date)})]},a))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-zinc-800 mb-3",children:"Customer Notes"}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded-lg border border-zinc-200",children:[e.jsx("p",{className:"text-sm text-zinc-600",children:"No notes added yet."}),e.jsx(i,{variant:"link",size:"sm",className:"mt-2",children:"+ Add Note"})]})]})]},"overview"),o==="pledges"&&e.jsx(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:S.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(b,{className:"w-12 h-12 text-zinc-300 mx-auto mb-3"}),e.jsx("p",{className:"text-zinc-500",children:"No pledges found"})]}):e.jsx("div",{className:"space-y-3",children:S.map(s=>e.jsx(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-4 border border-zinc-200 rounded-xl hover:border-amber-300 hover:bg-amber-50/30 transition-all cursor-pointer",onClick:()=>n(`/pledges/${s.id}`),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:d("w-10 h-10 rounded-lg flex items-center justify-center",s.status==="active"?"bg-amber-100":"bg-zinc-100"),children:e.jsx(b,{className:d("w-5 h-5",s.status==="active"?"text-amber-600":"text-zinc-400")})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-zinc-800",children:s.id}),e.jsx(v,{variant:s.status==="active"?"success":"default",children:s.status})]}),e.jsx("p",{className:"text-sm text-zinc-500",children:s.items})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-zinc-800",children:f(s.principal)}),e.jsxs("p",{className:"text-xs text-zinc-500",children:["Due: ",m(s.dueDate)]})]})]})},s.id))})},"pledges"),o==="renewals"&&e.jsx(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:R.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(j,{className:"w-12 h-12 text-zinc-300 mx-auto mb-3"}),e.jsx("p",{className:"text-zinc-500",children:"No renewals found"})]}):e.jsx("div",{className:"space-y-3",children:R.map(s=>e.jsx("div",{className:"p-4 border border-zinc-200 rounded-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-zinc-800",children:s.id}),e.jsxs("p",{className:"text-sm text-zinc-500",children:["Pledge: ",s.pledgeId]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-zinc-800",children:f(s.interest)}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[s.method," • ",m(s.date)]})]})]})},s.id))})},"renewals"),o==="redemptions"&&e.jsx(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:B.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(z,{className:"w-12 h-12 text-zinc-300 mx-auto mb-3"}),e.jsx("p",{className:"text-zinc-500",children:"No redemptions found"})]}):e.jsx("div",{className:"space-y-3",children:B.map(s=>e.jsx("div",{className:"p-4 border border-zinc-200 rounded-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm font-semibold text-zinc-800",children:s.id}),e.jsxs("p",{className:"text-sm text-zinc-500",children:["Pledge: ",s.pledgeId]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-emerald-600",children:f(s.total)}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[s.method," • ",m(s.date)]})]})]})},s.id))})},"redemptions"),o==="documents"&&e.jsxs(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-zinc-800 mb-3",children:"IC Front"}),t.icFrontImage?e.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>y("front"),children:[e.jsx("img",{src:t.icFrontImage,alt:"IC Front",className:"w-full h-48 object-cover rounded-xl border border-zinc-200"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-xl flex items-center justify-center",children:e.jsx(E,{className:"w-8 h-8 text-white"})})]}):e.jsx("div",{className:"h-48 border-2 border-dashed border-zinc-300 rounded-xl flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-zinc-400",children:[e.jsx(F,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Not uploaded"})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-zinc-800 mb-3",children:"IC Back"}),t.icBackImage?e.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>y("back"),children:[e.jsx("img",{src:t.icBackImage,alt:"IC Back",className:"w-full h-48 object-cover rounded-xl border border-zinc-200"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-xl flex items-center justify-center",children:e.jsx(E,{className:"w-8 h-8 text-white"})})]}):e.jsx("div",{className:"h-48 border-2 border-dashed border-zinc-300 rounded-xl flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-zinc-400",children:[e.jsx(F,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Not uploaded"})]})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(i,{variant:"outline",leftIcon:U,onClick:()=>n(`/customers/${x}/edit`),children:"Update Documents"})})]},"documents")]})})]})})]}),e.jsx(L,{isOpen:H,onClose:()=>u(!1),title:"Delete Customer",size:"sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(k,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-zinc-800",children:"Are you sure?"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"This action cannot be undone."})]})]}),e.jsxs("p",{className:"text-sm text-zinc-600 mb-4",children:["You are about to delete ",e.jsx("strong",{children:t?.name}),". All associated data including pledge history will be permanently removed."]}),t?.activePledges>0&&e.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg mb-4",children:e.jsxs("p",{className:"text-sm text-amber-800 flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"This customer has ",t.activePledges," active pledge(s)!"]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(i,{variant:"outline",fullWidth:!0,onClick:()=>u(!1),children:"Cancel"}),e.jsx(i,{variant:"danger",fullWidth:!0,leftIcon:k,loading:$,onClick:Q,children:"Delete"})]})]})}),e.jsx(L,{isOpen:!!p,onClose:()=>y(null),title:p==="front"?"IC Front":"IC Back",size:"lg",children:e.jsxs("div",{className:"p-4",children:[e.jsx("img",{src:p==="front"?t?.icFrontImage:t?.icBackImage,alt:p==="front"?"IC Front":"IC Back",className:"w-full rounded-lg"}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(i,{variant:"outline",leftIcon:Ne,children:"Download"})})]})})]}):e.jsx(G,{title:"Customer Not Found",children:e.jsxs(N,{className:"p-12 text-center",children:[e.jsx(O,{className:"w-16 h-16 text-zinc-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-zinc-800 mb-2",children:"Customer Not Found"}),e.jsx("p",{className:"text-zinc-500 mb-4",children:"The customer you're looking for doesn't exist."}),e.jsx(i,{variant:"accent",onClick:()=>n("/customers"),children:"Back to Customers"})]})})}export{Ve as default};
