import{H as S,J as z,K as k,M as P,w as Z,a as ee,u as se,r as h,g as ae,j as e,h as L,P as O,G as V,d as j,T as te,i as ne,o as re,S as I,s as G,e as A,L as le,I as J,N as W,E as ie,R as ce,v as de,q as oe}from"./index-o28qtZ4E.js";import{P as me}from"./PageWrapper-D4uzFYGf.js";import{m as X,B as g}from"./proxy-D6mGC7EI.js";import{C,M,I as x}from"./Modal-7Sg338uS.js";import{B as R}from"./Badge-Br48OPWn.js";import{M as xe,W as ue}from"./WhatsAppSettings-CJqNHWXW.js";import{B as q}from"./building-2-xsKCLuU5.js";import{D as K}from"./dollar-sign-CXfw5wgV.js";import{G as Y}from"./gem-D6g62J2O.js";import{S as B}from"./scale-DaJuZKuB.js";import{A as pe}from"./index-B9GDT2Wk.js";import{S as he}from"./save-CPbhu9KD.js";import{P as F}from"./plus-CQNf_PUI.js";import{T as E}from"./trash-2-D5yhdYvO.js";import{C as Q}from"./check-DGHPnJ4E.js";import{C as ge}from"./clock-C6f4WYXs.js";import"./history-DPeaAPFW.js";import"./key-Cqdn2BOI.js";import"./phone-B5sqxf62.js";import"./square-pen-DhoP9-Gi.js";const H={async getAll(){return P("/settings")},async getByCategory(n){return P(`/settings/by-category/${n}`)},async update(n){return z("/settings",{settings:n})},async getGoldPriceHistory(n=30){return P("/settings/gold-prices/history",{days:n})},async updateGoldPrices(n){return k("/settings/gold-prices",n)},async getCategories(){return P("/settings/categories")},async createCategory(n){return k("/settings/categories",n)},async updateCategory(n,c){return z(`/settings/categories/${n}`,c)},async deleteCategory(n){return S(`/settings/categories/${n}`)},async getPurities(){return P("/settings/purities")},async createPurity(n){return k("/settings/purities",n)},async updatePurity(n,c){return z(`/settings/purities/${n}`,c)},async deletePurity(n){return S(`/settings/purities/${n}`)},async getBanks(){return P("/settings/banks")},async createBank(n){return k("/settings/banks",n)},async updateBank(n,c){return z(`/settings/banks/${n}`,c)},async deleteBank(n){return S(`/settings/banks/${n}`)},async getStoneDeductions(){return P("/settings/stone-deductions")},async createStoneDeduction(n){return k("/settings/stone-deductions",n)},async updateStoneDeduction(n,c){return z(`/settings/stone-deductions/${n}`,c)},async deleteStoneDeduction(n){return S(`/settings/stone-deductions/${n}`)},async getInterestRates(){return P("/settings/interest-rates")},async createInterestRate(n){return k("/settings/interest-rates",n)},async updateInterestRate(n,c){return z(`/settings/interest-rates/${n}`,c)},async deleteInterestRate(n){return S(`/settings/interest-rates/${n}`)},async getTermsConditions(){return P("/settings/terms-conditions")},async createTermsCondition(n){return k("/settings/terms-conditions",n)},async updateTermsCondition(n,c){return z(`/settings/terms-conditions/${n}`,c)},async deleteTermsCondition(n){return S(`/settings/terms-conditions/${n}`)}};const fe=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],U=Z("percent",fe),w={company:{name:"Dsara Asset Ventures Sdn Bhd",license:"KPKT-PG-12345",address:"No. 123, Jalan Utama, 50000 Kuala Lumpur",phone:"03-1234 5678",email:"info@dsara.com",receiptHeader:"PAJAK GADAI BERLESEN",receiptFooter:"Terima kasih atas sokongan anda"},goldPrice:{source:"api",apiUrl:"",manualPrice:320,lastUpdated:new Date().toISOString(),updatedBy:"System"},marginPresets:[{id:1,value:80,label:"80%",isDefault:!0},{id:2,value:70,label:"70%",isDefault:!1},{id:3,value:60,label:"60%",isDefault:!1}],interestRules:{tier1:{months:6,rate:.5,label:"First 6 months"},tier2:{months:12,rate:1.5,label:"After 6 months (maintained)"},tier3:{months:999,rate:2,label:"Overdue (not maintained)"},gracePeriodDays:7},categories:[{id:1,name:"Ring",nameMs:"Cincin",active:!0},{id:2,name:"Chain",nameMs:"Rantai",active:!0},{id:3,name:"Bangle",nameMs:"Gelang",active:!0},{id:4,name:"Bracelet",nameMs:"Rantai Tangan",active:!0},{id:5,name:"Necklace",nameMs:"Kalung",active:!0},{id:6,name:"Earring",nameMs:"Anting-anting",active:!0},{id:7,name:"Pendant",nameMs:"Loket",active:!0},{id:8,name:"Brooch",nameMs:"Kerongsang",active:!0},{id:9,name:"Gold Bar",nameMs:"Jongkong Emas",active:!0},{id:10,name:"Other",nameMs:"Lain-lain",active:!0}],purities:[{id:1,value:"999",label:"999 (24K)",factor:.999,active:!0},{id:2,value:"916",label:"916 (22K)",factor:.916,active:!0},{id:3,value:"835",label:"835 (20K)",factor:.835,active:!0},{id:4,value:"750",label:"750 (18K)",factor:.75,active:!0},{id:5,value:"375",label:"375 (9K)",factor:.375,active:!0}],stoneDeduction:{defaultType:"percentage",defaultValue:5,categoryRules:[]},racks:[{id:"A",name:"Rack A",slots:20,description:"Main storage"},{id:"B",name:"Rack B",slots:20,description:"Secondary storage"},{id:"C",name:"Rack C",slots:15,description:"Forfeited items"}]},be=[{id:"company",label:"Company",icon:q},{id:"goldPrice",label:"Gold Price",icon:K},{id:"margin",label:"Margin %",icon:U},{id:"interest",label:"Interest Rules",icon:L},{id:"categories",label:"Categories",icon:O},{id:"purities",label:"Purities",icon:Y},{id:"stoneDeduction",label:"Stone Deduction",icon:B},{id:"racks",label:"Racks",icon:V},{id:"whatsapp",label:"WhatsApp",icon:xe}];function Oe(){const n=ee(),c=se(),[r,t]=h.useState("company"),[a,l]=h.useState(()=>{const o=ae(I.SETTINGS,null);return o?{...w,...o}:w}),[d,v]=h.useState(!1),[b,y]=h.useState(!0),[s,u]=h.useState(!1),p=async()=>{v(!0);try{const o=_(a),i=await H.update(o);if(i.success)G(I.SETTINGS,a),u(!1),window.dispatchEvent(new CustomEvent("settingsUpdated",{detail:a})),c(A({type:"success",title:"Saved",message:"Settings have been saved successfully"}));else throw new Error(i.message||"Save failed")}catch(o){console.error("API save failed:",o),G(I.SETTINGS,a),u(!1),window.dispatchEvent(new CustomEvent("settingsUpdated",{detail:a})),c(A({type:"warning",title:"Saved Locally",message:"Settings saved locally. Will sync to server when online."}))}finally{v(!1)}};h.useEffect(()=>{(async()=>{y(!0);try{const i=await H.getAll();if(i.success&&i.data){const m=T(i.data),f={...a,...m};l(f),G(I.SETTINGS,f)}}catch(i){console.error("Failed to load settings from API:",i)}finally{y(!1)}})()},[]);const N=(o,i)=>{l(m=>({...m,[o]:typeof i=="function"?i(m[o]):i})),u(!0)},T=o=>{const i={...w};if(!o)return i;if(o.company&&Array.isArray(o.company)){const m={};o.company.forEach(f=>{m[f.key_name]=f.value}),i.company={name:m.name||w.company.name,license:m.registration_no||w.company.license,address:m.address||w.company.address,phone:m.phone||w.company.phone,email:m.email||w.company.email,receiptHeader:m.receipt_header||w.company.receiptHeader,receiptFooter:m.receipt_footer||w.company.receiptFooter}}if(o.pledge&&Array.isArray(o.pledge)){const m={};if(o.pledge.forEach(f=>{m[f.key_name]=f.value}),m.default_loan_percentage){const f=parseInt(m.default_loan_percentage);i.marginPresets=i.marginPresets.map($=>({...$,isDefault:$.value===f}))}m.grace_period_days&&(i.interestRules.gracePeriodDays=parseInt(m.grace_period_days))}return i},_=o=>{const i=[];if(o.company&&i.push({category:"company",key_name:"name",value:o.company.name},{category:"company",key_name:"registration_no",value:o.company.license},{category:"company",key_name:"address",value:o.company.address},{category:"company",key_name:"phone",value:o.company.phone},{category:"company",key_name:"email",value:o.company.email},{category:"company",key_name:"receipt_header",value:o.company.receiptHeader},{category:"company",key_name:"receipt_footer",value:o.company.receiptFooter}),o.marginPresets){const m=o.marginPresets.find(f=>f.isDefault);m&&i.push({category:"pledge",key_name:"default_loan_percentage",value:String(m.value)})}return o.interestRules&&i.push({category:"pledge",key_name:"grace_period_days",value:String(o.interestRules.gracePeriodDays)}),i},D=()=>{if(b)return e.jsxs(C,{className:"p-12 flex items-center justify-center",children:[e.jsx(le,{className:"w-6 h-6 animate-spin text-amber-500"}),e.jsx("span",{className:"ml-3 text-zinc-600",children:"Loading settings..."})]});switch(r){case"company":return e.jsx(je,{settings:a,updateSettings:N});case"goldPrice":return e.jsx(ve,{settings:a,updateSettings:N,dispatch:c});case"margin":return e.jsx(ye,{settings:a,updateSettings:N});case"interest":return e.jsx(Ne,{settings:a,updateSettings:N});case"categories":return e.jsx(Ce,{settings:a,updateSettings:N});case"purities":return e.jsx(we,{settings:a,updateSettings:N});case"stoneDeduction":return e.jsx(Pe,{settings:a,updateSettings:N});case"racks":return e.jsx(ze,{settings:a,updateSettings:N});case"whatsapp":return e.jsx(ue,{});default:return null}};return e.jsx(me,{title:"Settings",subtitle:"Configure system settings and master data",actions:e.jsx(g,{variant:"accent",leftIcon:he,onClick:p,loading:d,disabled:!s||b,children:"Save Changes"}),children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"lg:w-64 flex-shrink-0",children:[e.jsx(C,{className:"p-2",children:e.jsx("nav",{className:"space-y-1",children:be.map(o=>{const i=o.icon;return e.jsxs("button",{onClick:()=>t(o.id),className:j("w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-all",r===o.id?"bg-amber-500/10 text-amber-600 font-medium":"text-zinc-600 hover:bg-zinc-50"),children:[e.jsx(i,{className:j("w-5 h-5",r===o.id?"text-amber-500":"text-zinc-400")}),o.label]},o.id)})})}),s&&e.jsx(X.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-4",children:e.jsx(C,{className:"p-4 border-amber-200 bg-amber-50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800",children:"Unsaved Changes"}),e.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Don't forget to save your changes."})]})]})})}),e.jsx(C,{className:"mt-4 p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>n("/settings/users"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(ne,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:"User Management"}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Manage users & permissions"})]})]}),e.jsx(re,{className:"w-5 h-5 text-zinc-400"})]})})]}),e.jsx("div",{className:"flex-1",children:e.jsx(pe,{mode:"wait",children:e.jsx(X.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:D()},r)})})]})})}function je({settings:n,updateSettings:c}){const r=n.company,t=(a,l)=>{c("company",{...r,[a]:l})};return e.jsxs(C,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 mb-6 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-amber-500"}),"Company Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(x,{label:"Company Name",value:r.name,onChange:a=>t("name",a.target.value),placeholder:"Enter company name"}),e.jsx(x,{label:"License Number (KPKT)",value:r.license,onChange:a=>t("license",a.target.value),placeholder:"KPKT-PG-XXXXX"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(x,{label:"Address",value:r.address,onChange:a=>t("address",a.target.value),placeholder:"Full business address"})}),e.jsx(x,{label:"Phone",value:r.phone,onChange:a=>t("phone",a.target.value),placeholder:"03-XXXX XXXX"}),e.jsx(x,{label:"Email",type:"email",value:r.email,onChange:a=>t("email",a.target.value),placeholder:"info@company.com"}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(x,{label:"Receipt Header Text",value:r.receiptHeader,onChange:a=>t("receiptHeader",a.target.value),placeholder:"Text shown at top of receipts"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(x,{label:"Receipt Footer Text",value:r.receiptFooter,onChange:a=>t("receiptFooter",a.target.value),placeholder:"Text shown at bottom of receipts"})})]})]})}function ve({settings:n,updateSettings:c,dispatch:r}){const t=n.goldPrice,[a,l]=h.useState(!1),[d,v]=h.useState(null),[b,y]=h.useState(null),[s,u]=h.useState(!1),p=[{code:"999",karat:"24K",percentage:99.9},{code:"916",karat:"22K",percentage:91.6},{code:"875",karat:"21K",percentage:87.5},{code:"750",karat:"18K",percentage:75},{code:"585",karat:"14K",percentage:58.5},{code:"375",karat:"9K",percentage:37.5}];h.useEffect(()=>{t.source==="api"&&T()},[t.source]);const N=(i,m)=>{c("goldPrice",{...t,[i]:m,lastUpdated:new Date().toISOString(),updatedBy:"Admin"})},T=async()=>{try{u(!0),y(null);const i=await W.getDashboardPrices();if(i.data){const m=i.data,f=m.current?.prices?.gold?.per_gram||0;v({price999:f,carat:m.carat||{},source:m.current?.source||"api",change:m.change,lastUpdated:m.last_updated}),f>0&&c("goldPrice",{...t,manualPrice:f,lastUpdated:new Date().toISOString(),updatedBy:"API"})}}catch(i){console.error("API fetch error:",i),y("Failed to fetch from API. Please check backend connection.")}finally{u(!1)}},_=async()=>{l(!0);try{t.source==="api"?(await W.refreshPrices(),await T(),r(A({type:"success",title:"Gold Price Updated",message:`Live price: RM ${d?.price999?.toFixed(2)||t.manualPrice?.toFixed(2)}/g`}))):(N("lastUpdated",new Date().toISOString()),r(A({type:"success",title:"Price Updated",message:`Manual price: RM ${t.manualPrice?.toFixed(2)}/g`})))}catch(i){console.error("Refresh error:",i),r(A({type:"error",title:"Refresh Failed",message:"Could not refresh gold price. Please try again."}))}finally{l(!1)}},D=t.source==="api"&&d?.price999?d.price999:t.manualPrice,o=()=>t.source==="manual"?e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs",children:"Manual"}):b?e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded-full text-xs",children:"API Error"}):d?.source==="metalpriceapi"?e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-xs",children:"ðŸŸ¢ Live"}):d?.source==="cache"?e.jsx("span",{className:"px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded-full text-xs",children:"ðŸŸ¡ Cached"}):e.jsx("span",{className:"px-2 py-0.5 bg-zinc-100 text-zinc-700 rounded-full text-xs",children:"Loading..."});return e.jsxs(C,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 mb-6 flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-amber-500"}),"Gold Price Settings"]}),e.jsx("div",{className:"p-6 bg-gradient-to-r from-amber-500 to-amber-600 rounded-xl text-white mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"text-amber-100 text-sm",children:"Current Gold Price (999)"}),o()]}),e.jsx("p",{className:"text-4xl font-bold mt-1",children:s?e.jsx("span",{className:"text-2xl",children:"Loading..."}):`RM ${D?.toFixed(2)||"0.00"}/g`}),t.source==="api"&&d?.change&&d.change.amount!==0&&e.jsxs("p",{className:j("text-sm mt-1 flex items-center gap-1",d.change.direction==="up"?"text-green-200":"text-red-200"),children:[d.change.direction==="up"?e.jsx(L,{className:"w-4 h-4"}):e.jsx(ie,{className:"w-4 h-4"}),d.change.direction==="up"?"+":"","RM ",d.change.amount?.toFixed(2)," (",d.change.percent?.toFixed(2),"%)",e.jsx("span",{className:"text-amber-200 ml-1",children:"vs yesterday"})]}),e.jsxs("p",{className:"text-amber-100 text-xs mt-2 flex items-center gap-1",children:[e.jsx(ge,{className:"w-3 h-3"}),"Last updated:"," ",new Date(d?.lastUpdated||t.lastUpdated).toLocaleString()]})]}),e.jsx(g,{variant:"outline",className:"bg-white/20 border-white/30 text-white hover:bg-white/30",leftIcon:ce,onClick:_,loading:a||s,children:"Refresh"})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-3",children:"Price Source"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:j("flex-1 flex items-center gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all",t.source==="manual"?"border-amber-500 bg-amber-50":"border-zinc-200 hover:border-zinc-300"),children:[e.jsx("input",{type:"radio",name:"priceSource",value:"manual",checked:t.source==="manual",onChange:()=>N("source","manual"),className:"sr-only"}),e.jsx("div",{className:j("w-5 h-5 rounded-full border-2 flex items-center justify-center",t.source==="manual"?"border-amber-500":"border-zinc-300"),children:t.source==="manual"&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:"Manual Entry"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Enter price manually each day"})]})]}),e.jsxs("label",{className:j("flex-1 flex items-center gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all",t.source==="api"?"border-amber-500 bg-amber-50":"border-zinc-200 hover:border-zinc-300"),children:[e.jsx("input",{type:"radio",name:"priceSource",value:"api",checked:t.source==="api",onChange:()=>N("source","api"),className:"sr-only"}),e.jsx("div",{className:j("w-5 h-5 rounded-full border-2 flex items-center justify-center",t.source==="api"?"border-amber-500":"border-zinc-300"),children:t.source==="api"&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:"API (Automatic)"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Fetch from gold price API"})]})]})]})]}),t.source==="manual"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsx(x,{label:"Gold Price (RM/gram) - 999 Purity",type:"number",step:"0.01",value:t.manualPrice,onChange:i=>N("manualPrice",parseFloat(i.target.value)||0),leftIcon:K})}),t.source==="api"&&e.jsx("div",{className:j("p-4 rounded-xl",b?"bg-red-50":"bg-green-50"),children:b?e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),b]}):e.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),"Connected to MetalPriceAPI. Prices update automatically."]})}),t.source==="api"&&d&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-700 mb-3",children:"Price by Purity (RM/gram)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:p.map(i=>{const m=d.carat?.[i.code]||D*(i.percentage/100);return e.jsxs("div",{className:"p-3 bg-zinc-50 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-zinc-500",children:i.karat}),e.jsxs("p",{className:"text-sm font-bold text-zinc-800",children:["RM ",m.toFixed(2)]})]},i.code)})})]})]})}function ye({settings:n,updateSettings:c}){const[r,t]=h.useState(!1),[a,l]=h.useState(""),d=n.marginPresets,v=s=>{const u=d.map(p=>({...p,isDefault:p.id===s}));c("marginPresets",u)},b=s=>{const u=d.filter(p=>p.id!==s);c("marginPresets",u)},y=()=>{const s=parseInt(a);if(s>0&&s<=100){const u=[...d,{id:Date.now(),value:s,label:`${s}%`,isDefault:!1}];c("marginPresets",u),l(""),t(!1)}};return e.jsxs(C,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-amber-500"}),"Margin Percentage Presets"]}),e.jsx(g,{variant:"outline",size:"sm",leftIcon:F,onClick:()=>t(!0),children:"Add Preset"})]}),e.jsx("p",{className:"text-sm text-zinc-500 mb-6",children:"These presets appear as quick-select buttons when creating a new pledge. The default preset will be pre-selected."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(s=>e.jsxs("div",{className:j("p-4 rounded-xl border-2 transition-all",s.isDefault?"border-amber-500 bg-amber-50":"border-zinc-200 hover:border-zinc-300"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-3xl font-bold text-zinc-800",children:[s.value,"%"]}),s.isDefault&&e.jsx(R,{variant:"success",children:"Default"})]}),e.jsxs("div",{className:"flex gap-2",children:[!s.isDefault&&e.jsx(g,{variant:"outline",size:"sm",onClick:()=>v(s.id),className:"flex-1",children:"Set Default"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>b(s.id),className:"text-red-500 hover:bg-red-50",children:e.jsx(E,{className:"w-4 h-4"})})]})]},s.id))}),e.jsx(M,{isOpen:r,onClose:()=>t(!1),title:"Add Margin Preset",size:"sm",children:e.jsxs("div",{className:"p-5",children:[e.jsx(x,{label:"Margin Percentage",type:"number",min:"1",max:"100",value:a,onChange:s=>l(s.target.value),placeholder:"e.g. 75",rightElement:e.jsx("span",{className:"text-zinc-400",children:"%"})}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(g,{variant:"outline",fullWidth:!0,onClick:()=>t(!1),children:"Cancel"}),e.jsx(g,{variant:"accent",fullWidth:!0,onClick:y,children:"Add Preset"})]})]})})]})}function Ne({settings:n,updateSettings:c}){const r=n.interestRules,t=(l,d,v)=>{c("interestRules",{...r,[l]:{...r[l],[d]:v}})},a=l=>{c("interestRules",{...r,gracePeriodDays:parseInt(l)||0})};return e.jsxs(C,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 mb-6 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-amber-500"}),"Interest Rate Rules"]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsx("p",{className:"font-medium mb-1",children:"Interest Calculation (KPKT Compliant)"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-600",children:[e.jsx("li",{children:"Interest is calculated monthly based on principal amount"}),e.jsx("li",{children:"Tier upgrades apply to all outstanding months"}),e.jsx("li",{children:'Renewal payments reset the "maintained" status'})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-xl border border-zinc-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center",children:e.jsx("span",{className:"text-emerald-600 font-bold text-sm",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:r.tier1.label}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Initial rate for new pledges"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{label:"Duration (months)",type:"number",value:r.tier1.months,onChange:l=>t("tier1","months",parseInt(l.target.value)||0)}),e.jsx(x,{label:"Interest Rate (%)",type:"number",step:"0.1",value:r.tier1.rate,onChange:l=>t("tier1","rate",parseFloat(l.target.value)||0),rightElement:e.jsx("span",{className:"text-zinc-400",children:"%"})})]})]}),e.jsxs("div",{className:"p-4 rounded-xl border border-zinc-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center",children:e.jsx("span",{className:"text-amber-600 font-bold text-sm",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:r.tier2.label}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Rate after initial period if renewed"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{label:"Duration (months)",type:"number",value:r.tier2.months,onChange:l=>t("tier2","months",parseInt(l.target.value)||0)}),e.jsx(x,{label:"Interest Rate (%)",type:"number",step:"0.1",value:r.tier2.rate,onChange:l=>t("tier2","rate",parseFloat(l.target.value)||0),rightElement:e.jsx("span",{className:"text-zinc-400",children:"%"})})]})]}),e.jsxs("div",{className:"p-4 rounded-xl border border-red-200 bg-red-50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("span",{className:"text-red-600 font-bold text-sm",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:r.tier3.label}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Penalty rate for overdue pledges"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{label:"Interest Rate (%)",type:"number",step:"0.1",value:r.tier3.rate,onChange:l=>t("tier3","rate",parseFloat(l.target.value)||0),rightElement:e.jsx("span",{className:"text-zinc-400",children:"%"})}),e.jsx(x,{label:"Grace Period (days)",type:"number",value:r.gracePeriodDays,onChange:l=>a(l.target.value),helperText:"Days before penalty applies"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-zinc-50 rounded-xl",children:[e.jsx("p",{className:"text-sm font-medium text-zinc-700 mb-2",children:"Rate Summary:"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs(R,{variant:"success",children:[r.tier1.rate,"%"]}),e.jsx("span",{className:"text-zinc-400",children:"â†’"}),e.jsxs(R,{variant:"warning",children:[r.tier2.rate,"%"]}),e.jsx("span",{className:"text-zinc-400",children:"â†’"}),e.jsxs(R,{variant:"error",children:[r.tier3.rate,"%"]})]})]})]})}function Ce({settings:n,updateSettings:c}){const[r,t]=h.useState(!1),[a,l]=h.useState({name:"",nameMs:""}),d=n.categories,v=()=>{if(a.name){const s=[...d,{id:Date.now(),name:a.name,nameMs:a.nameMs||a.name,active:!0}];c("categories",s),l({name:"",nameMs:""}),t(!1)}},b=s=>{const u=d.map(p=>p.id===s?{...p,active:!p.active}:p);c("categories",u)},y=s=>{const u=d.filter(p=>p.id!==s);c("categories",u)};return e.jsxs(C,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5 text-amber-500"}),"Item Categories"]}),e.jsx(g,{variant:"outline",size:"sm",leftIcon:F,onClick:()=>t(!0),children:"Add Category"})]}),e.jsx("div",{className:"space-y-2",children:d.map(s=>e.jsxs("div",{className:j("flex items-center justify-between p-4 rounded-xl border transition-all",s.active?"border-zinc-200 bg-white":"border-zinc-100 bg-zinc-50 opacity-60"),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>b(s.id),className:j("w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",s.active?"bg-emerald-500 border-emerald-500":"border-zinc-300"),children:s.active&&e.jsx(Q,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:s.name}),e.jsx("p",{className:"text-sm text-zinc-500",children:s.nameMs})]})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>y(s.id),className:"text-zinc-400 hover:text-red-500",children:e.jsx(E,{className:"w-4 h-4"})})]},s.id))}),e.jsx(M,{isOpen:r,onClose:()=>t(!1),title:"Add Category",size:"sm",children:e.jsxs("div",{className:"p-5",children:[e.jsx(x,{label:"Category Name (English)",value:a.name,onChange:s=>l({...a,name:s.target.value}),placeholder:"e.g. Ring"}),e.jsx(x,{label:"Category Name (Malay)",value:a.nameMs,onChange:s=>l({...a,nameMs:s.target.value}),placeholder:"e.g. Cincin"}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(g,{variant:"outline",fullWidth:!0,onClick:()=>t(!1),children:"Cancel"}),e.jsx(g,{variant:"accent",fullWidth:!0,onClick:v,children:"Add Category"})]})]})})]})}function we({settings:n,updateSettings:c}){const[r,t]=h.useState(!1),[a,l]=h.useState({value:"",label:"",factor:""}),d=n.purities,v=()=>{if(a.value&&a.factor){const s=[...d,{id:Date.now(),value:a.value,label:a.label||a.value,factor:parseFloat(a.factor)||0,active:!0}];c("purities",s),l({value:"",label:"",factor:""}),t(!1)}},b=s=>{const u=d.map(p=>p.id===s?{...p,active:!p.active}:p);c("purities",u)},y=s=>{const u=d.filter(p=>p.id!==s);c("purities",u)};return e.jsxs(C,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-amber-500"}),"Gold Purities"]}),e.jsx(g,{variant:"outline",size:"sm",leftIcon:F,onClick:()=>t(!0),children:"Add Purity"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(s=>e.jsxs("div",{className:j("p-4 rounded-xl border-2 transition-all",s.active?"border-amber-200 bg-amber-50":"border-zinc-100 bg-zinc-50 opacity-60"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-2xl font-bold text-zinc-800",children:s.value}),e.jsx("button",{onClick:()=>b(s.id),className:j("w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",s.active?"bg-emerald-500 border-emerald-500":"border-zinc-300"),children:s.active&&e.jsx(Q,{className:"w-3 h-3 text-white"})})]}),e.jsx("p",{className:"text-sm text-zinc-500 mb-3",children:s.label}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-zinc-400",children:["Factor: ",s.factor]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>y(s.id),className:"text-zinc-400 hover:text-red-500",children:e.jsx(E,{className:"w-4 h-4"})})]})]},s.id))}),e.jsx(M,{isOpen:r,onClose:()=>t(!1),title:"Add Purity",size:"sm",children:e.jsxs("div",{className:"p-5",children:[e.jsx(x,{label:"Purity Code",value:a.value,onChange:s=>l({...a,value:s.target.value}),placeholder:"e.g. 916"}),e.jsx(x,{label:"Display Label",value:a.label,onChange:s=>l({...a,label:s.target.value}),placeholder:"e.g. 916 (22K)"}),e.jsx(x,{label:"Factor (decimal)",type:"number",step:"0.001",value:a.factor,onChange:s=>l({...a,factor:s.target.value}),placeholder:"e.g. 0.916",helperText:"Used for value calculation"}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(g,{variant:"outline",fullWidth:!0,onClick:()=>t(!1),children:"Cancel"}),e.jsx(g,{variant:"accent",fullWidth:!0,onClick:v,children:"Add Purity"})]})]})})]})}function Pe({settings:n,updateSettings:c}){const r=n.stoneDeduction,t=(a,l)=>{c("stoneDeduction",{...r,[a]:l})};return e.jsxs(C,{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 mb-6 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-amber-500"}),"Stone Deduction Rules"]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-xl mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Stone deduction is applied to gross weight to calculate net gold weight for valuation."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-3",children:"Default Deduction Type"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:j("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 cursor-pointer transition-all",r.defaultType==="percentage"?"border-amber-500 bg-amber-50":"border-zinc-200 hover:border-zinc-300"),children:[e.jsx("input",{type:"radio",name:"deductionType",value:"percentage",checked:r.defaultType==="percentage",onChange:()=>t("defaultType","percentage"),className:"sr-only"}),e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Percentage"})]}),e.jsxs("label",{className:j("flex-1 flex items-center justify-center gap-2 p-3 rounded-lg border-2 cursor-pointer transition-all",r.defaultType==="fixed"?"border-amber-500 bg-amber-50":"border-zinc-200 hover:border-zinc-300"),children:[e.jsx("input",{type:"radio",name:"deductionType",value:"fixed",checked:r.defaultType==="fixed",onChange:()=>t("defaultType","fixed"),className:"sr-only"}),e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Fixed (g)"})]})]})]}),e.jsx(x,{label:`Default Value (${r.defaultType==="percentage"?"%":"grams"})`,type:"number",step:"0.01",value:r.defaultValue,onChange:a=>t("defaultValue",parseFloat(a.target.value)||0),rightElement:e.jsx("span",{className:"text-zinc-400",children:r.defaultType==="percentage"?"%":"g"})})]}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded-xl",children:[e.jsx("p",{className:"text-sm font-medium text-zinc-700 mb-2",children:"Example Calculation:"}),e.jsxs("div",{className:"text-sm text-zinc-600",children:[e.jsx("p",{children:"Gross Weight: 10.00g"}),e.jsxs("p",{children:["Stone Deduction: ",r.defaultValue,r.defaultType==="percentage"?"%":"g"]}),e.jsxs("p",{className:"font-medium text-zinc-800 mt-1",children:["Net Weight:"," ",r.defaultType==="percentage"?(10*(1-r.defaultValue/100)).toFixed(2):(10-r.defaultValue).toFixed(2),"g"]})]})]})]})}function ze({settings:n,updateSettings:c}){const[r,t]=h.useState(!1),[a,l]=h.useState({id:"",name:"",slots:20,description:""}),d=n.racks,v=()=>{if(a.id&&a.name){const s=[...d,{id:a.id.toUpperCase(),name:a.name,slots:parseInt(a.slots)||20,description:a.description}];c("racks",s),l({id:"",name:"",slots:20,description:""}),t(!1)}},b=s=>{const u=d.filter(p=>p.id!==s);c("racks",u)},y=d.reduce((s,u)=>s+u.slots,0);return e.jsxs(C,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-zinc-800 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-amber-500"}),"Rack / Locker Setup"]}),e.jsx(g,{variant:"outline",size:"sm",leftIcon:F,onClick:()=>t(!0),children:"Add Rack"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-zinc-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-zinc-500",children:"Total Racks"}),e.jsx("p",{className:"text-2xl font-bold text-zinc-800",children:d.length})]}),e.jsxs("div",{className:"p-4 bg-amber-50 rounded-xl",children:[e.jsx("p",{className:"text-sm text-amber-600",children:"Total Slots"}),e.jsx("p",{className:"text-2xl font-bold text-amber-600",children:y})]})]}),e.jsx("div",{className:"space-y-3",children:d.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl border border-zinc-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-amber-500 to-amber-600 flex items-center justify-center",children:e.jsx("span",{className:"text-xl font-bold text-white",children:s.id})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:s.name}),e.jsx("p",{className:"text-sm text-zinc-500",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-semibold text-zinc-800",children:s.slots}),e.jsx("p",{className:"text-xs text-zinc-500",children:"slots"})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>b(s.id),className:"text-zinc-400 hover:text-red-500",children:e.jsx(E,{className:"w-4 h-4"})})]})]},s.id))}),e.jsx(M,{isOpen:r,onClose:()=>t(!1),title:"Add Rack",size:"sm",children:e.jsxs("div",{className:"p-5",children:[e.jsx(x,{label:"Rack ID",value:a.id,onChange:s=>l({...a,id:s.target.value}),placeholder:"e.g. D",maxLength:2}),e.jsx(x,{label:"Rack Name",value:a.name,onChange:s=>l({...a,name:s.target.value}),placeholder:"e.g. Rack D"}),e.jsx(x,{label:"Number of Slots",type:"number",value:a.slots,onChange:s=>l({...a,slots:s.target.value}),placeholder:"20"}),e.jsx(x,{label:"Description",value:a.description,onChange:s=>l({...a,description:s.target.value}),placeholder:"e.g. High-value items"}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(g,{variant:"outline",fullWidth:!0,onClick:()=>t(!1),children:"Cancel"}),e.jsx(g,{variant:"accent",fullWidth:!0,onClick:v,children:"Add Rack"})]})]})})]})}export{Oe as default};
