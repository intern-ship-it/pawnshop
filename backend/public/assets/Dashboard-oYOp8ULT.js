import{a as D,u as R,b,r as S,f as v,j as e,R as p,d as a,W as w,T as y,L as A,P as L,h as T,i as _}from"./index-o28qtZ4E.js";import{f as r}from"./formatters-BhAPqf4o.js";import{P as z}from"./plus-CQNf_PUI.js";import{C as G}from"./credit-card-CogcOOr3.js";import{A as C}from"./arrow-right-B_qPtgmv.js";import{B as O}from"./banknote-DTxVb2uI.js";import{C as K}from"./clock-C6f4WYXs.js";import{S as U}from"./scale-DaJuZKuB.js";import{L as W}from"./lock-D12x4_nz.js";function X(){const i=D(),x=R(),{user:P,role:$}=b(s=>s.auth),{goldPrice:c}=b(s=>s.ui),{summary:l,todayStats:n,paymentSplit:u,dueReminders:o,overduePledges:E,goldPrices:d,loading:m,error:g,lastFetched:h}=b(s=>s.dashboard);S.useEffect(()=>{x(v())},[x]);const j=()=>{x(v())},t={todayPledges:{count:n?.newPledges?.count||0,amount:n?.newPledges?.amount||0,trend:l?.monthlyGrowth>0?`+${l?.monthlyGrowth}%`:`${l?.monthlyGrowth||0}%`},renewals:{amount:n?.renewals?.amount||0,transactions:n?.renewals?.count||0},redemptions:{count:n?.redemptions?.count||0,amount:n?.redemptions?.amount||0},paymentSplit:{cash:u?.cash?.percentage||0,online:u?.transfer?.percentage||0},overdue:{count:o?.overdue?.length||l?.totalOverdue||0}},N=[...(o?.oneDay||[]).map(s=>({...s,urgency:"1 day"})),...(o?.threeDays||[]).map(s=>({...s,urgency:"3 days"})),...(o?.sevenDays||[]).map(s=>({...s,urgency:"7 days"}))].slice(0,5),f=[{id:1,type:"Weight Discrepancy",icon:U,description:"Item #G-1002 weight recorded as 5.2g vs expected 5.5g.",severity:"critical"},{id:2,type:"Pending Safe Audit",icon:W,description:"Daily safe audit not completed.",severity:"warning"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-800",children:"Dashboard Overview"}),e.jsxs("p",{className:"text-zinc-500 mt-1",children:["Welcome back, ",P?.name||"User","! Here's your business summary for today."]}),h&&e.jsxs("p",{className:"text-xs text-zinc-400 mt-1",children:["Last updated: ",new Date(h).toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:j,disabled:m,className:"flex items-center gap-2 px-3 py-2 text-zinc-600 hover:text-zinc-800 hover:bg-zinc-100 rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(p,{className:a("w-4 h-4",m&&"animate-spin")}),m?"Loading...":"Refresh"]}),e.jsxs("button",{onClick:()=>i("/pledges/new"),className:"flex items-center gap-2 px-4 py-2.5 bg-zinc-900 text-white rounded-lg font-medium hover:bg-zinc-800 transition-colors shadow-sm",children:[e.jsx(z,{className:"w-4 h-4"}),"New Pledge"]}),e.jsxs("button",{onClick:()=>i("/renewals"),className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-amber-200 text-amber-700 rounded-lg font-medium hover:bg-amber-50 transition-colors",children:[e.jsx(p,{className:"w-4 h-4 text-amber-500"}),"Renew"]}),e.jsxs("button",{onClick:()=>i("/redemptions"),className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-zinc-200 text-zinc-700 rounded-lg font-medium hover:bg-zinc-50 transition-colors",children:[e.jsx(w,{className:"w-4 h-4 text-zinc-500"}),"Redeem"]})]})]}),g&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(y,{className:"w-5 h-5 text-red-500"}),e.jsx("p",{className:"text-red-700",children:g}),e.jsx("button",{onClick:j,className:"ml-auto text-red-600 hover:text-red-800 text-sm font-medium",children:"Retry"})]}),m&&!h&&e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(A,{className:"w-8 h-8 text-amber-500 animate-spin"}),e.jsx("span",{className:"ml-3 text-zinc-600",children:"Loading dashboard data..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{onClick:()=>i("/pledges"),className:"bg-white rounded-xl border border-zinc-200 border-l-4 border-l-zinc-900 p-5 shadow-sm hover:shadow-md transition-all cursor-pointer group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-zinc-100 flex items-center justify-center group-hover:bg-zinc-200 transition-colors",children:e.jsx(z,{className:"w-5 h-5 text-zinc-600"})}),e.jsx("span",{className:a("text-xs font-bold px-2 py-0.5 rounded-full",l?.monthlyGrowth>=0?"text-emerald-600 bg-emerald-50":"text-red-600 bg-red-50"),children:t.todayPledges.trend})]}),e.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Today's New Pledges"}),e.jsxs("p",{className:"text-2xl font-bold text-zinc-900",children:[t.todayPledges.count," ",e.jsx("span",{className:"text-sm font-normal text-zinc-400",children:"items"})]}),e.jsx("p",{className:"text-sm font-semibold text-zinc-700 mt-1",children:r(t.todayPledges.amount)})]}),e.jsxs("div",{onClick:()=>i("/renewals"),className:"bg-white rounded-xl border border-zinc-200 border-l-4 border-l-amber-500 p-5 shadow-sm hover:shadow-md transition-all cursor-pointer group",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-50 flex items-center justify-center group-hover:bg-amber-100 transition-colors",children:e.jsx(p,{className:"w-5 h-5 text-amber-600"})})}),e.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Renewal Collected"}),e.jsx("p",{className:"text-2xl font-bold text-zinc-900",children:r(t.renewals.amount)}),e.jsxs("p",{className:"text-sm text-zinc-500 mt-1",children:[t.renewals.transactions," transactions today"]})]}),e.jsxs("div",{onClick:()=>i("/redemptions"),className:"bg-white rounded-xl border border-zinc-200 border-l-4 border-l-emerald-500 p-5 shadow-sm hover:shadow-md transition-all cursor-pointer group",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-50 flex items-center justify-center group-hover:bg-emerald-100 transition-colors",children:e.jsx(w,{className:"w-5 h-5 text-emerald-600"})})}),e.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Redemption Count"}),e.jsxs("p",{className:"text-2xl font-bold text-zinc-900",children:[t.redemptions.count," ",e.jsx("span",{className:"text-sm font-normal text-zinc-400",children:"items"})]}),e.jsx("p",{className:"text-sm font-semibold text-emerald-600 mt-1",children:r(t.redemptions.amount)})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 p-5 shadow-sm",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center",children:e.jsx(G,{className:"w-5 h-5 text-blue-600"})})}),e.jsx("p",{className:"text-sm text-zinc-500 mb-3",children:"Payment Split"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsxs("span",{className:"text-sm text-zinc-600",children:["Cash ",t.paymentSplit.cash,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-400"}),e.jsxs("span",{className:"text-sm text-zinc-600",children:["Online ",t.paymentSplit.online,"%"]})]})]}),e.jsx("div",{className:"mt-2 h-2 bg-zinc-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all duration-500",style:{width:`${t.paymentSplit.cash}%`}})})]}),e.jsxs("div",{onClick:()=>i("/pledges?status=overdue"),className:"bg-white rounded-xl border border-zinc-200 border-l-4 border-l-red-500 p-5 shadow-sm hover:shadow-md transition-all cursor-pointer group",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-50 flex items-center justify-center group-hover:bg-red-100 transition-colors",children:e.jsx(y,{className:"w-5 h-5 text-red-600"})})}),e.jsx("p",{className:"text-sm text-zinc-500 mb-1",children:"Overdue Alerts"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[t.overdue.count," ",e.jsx("span",{className:"text-sm font-normal text-zinc-400",children:"items"})]}),e.jsxs("p",{className:"text-sm text-red-500 mt-1 flex items-center gap-1 group-hover:underline",children:["View overdue items ",e.jsx(C,{className:"w-3 h-3"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-zinc-800 to-zinc-900 rounded-xl p-5 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(L,{className:"w-5 h-5 text-amber-400"}),e.jsx("span",{className:"text-zinc-400 text-sm",children:"Total Active Pledges"})]}),e.jsx("p",{className:"text-3xl font-bold",children:l?.totalPledges||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl p-5 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(O,{className:"w-5 h-5 text-amber-100"}),e.jsx("span",{className:"text-amber-100 text-sm",children:"Total Outstanding"})]}),e.jsx("p",{className:"text-3xl font-bold",children:r(l?.totalOutstanding||0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl p-5 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(T,{className:"w-5 h-5 text-emerald-100"}),e.jsx("span",{className:"text-emerald-100 text-sm",children:"Monthly Revenue"})]}),e.jsx("p",{className:"text-3xl font-bold",children:r(l?.monthlyRevenue||0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-5 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(_,{className:"w-5 h-5 text-blue-100"}),e.jsx("span",{className:"text-blue-100 text-sm",children:"Total Customers"})]}),e.jsx("p",{className:"text-3xl font-bold",children:l?.totalCustomers||0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-800",children:"Gold Prices (RM/g)"}),d?.updated_at&&e.jsxs("span",{className:"text-xs text-zinc-400",children:["Updated: ",new Date(d.updated_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-amber-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-amber-600 font-medium",children:"999 (24K)"}),e.jsx("p",{className:"text-lg font-bold text-amber-700",children:r(d?.price_999||c?.price999||305.5)})]}),e.jsxs("div",{className:"bg-amber-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-amber-600 font-medium",children:"916 (22K)"}),e.jsx("p",{className:"text-lg font-bold text-amber-700",children:r(d?.price_916||c?.price916||280.25)})]}),e.jsxs("div",{className:"bg-zinc-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-zinc-500 font-medium",children:"875 (21K)"}),e.jsx("p",{className:"text-lg font-bold text-zinc-700",children:r(d?.price_875||c?.price875||267.3)})]}),e.jsxs("div",{className:"bg-zinc-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-zinc-500 font-medium",children:"750 (18K)"}),e.jsx("p",{className:"text-lg font-bold text-zinc-700",children:r(d?.price_750||c?.price750||229.15)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 p-5 shadow-sm lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-800",children:"Due Reminders"}),e.jsxs("button",{onClick:()=>i("/pledges?status=active"),className:"text-sm text-amber-600 hover:text-amber-700 font-medium flex items-center gap-1",children:["View all ",e.jsx(C,{className:"w-3 h-3"})]})]}),N.length>0?e.jsx("div",{className:"space-y-3",children:N.map((s,k)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-50 rounded-lg hover:bg-zinc-100 transition-colors cursor-pointer",onClick:()=>i(`/pledges/${s.id}`),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:a("w-2 h-2 rounded-full",s.urgency==="1 day"?"bg-red-500":s.urgency==="3 days"?"bg-amber-500":"bg-blue-500")}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-zinc-800",children:s.pledge_no||s.pledgeNo}),e.jsx("p",{className:"text-sm text-zinc-500",children:s.customer?.name||s.customerName})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-zinc-800",children:r(s.loan_amount||s.amount)}),e.jsxs("p",{className:a("text-xs font-medium",s.urgency==="1 day"?"text-red-500":s.urgency==="3 days"?"text-amber-500":"text-blue-500"),children:["Due in ",s.urgency]})]})]},s.id||k))}):e.jsxs("div",{className:"text-center py-8 text-zinc-400",children:[e.jsx(K,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No upcoming due dates"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-800",children:"Stock Alerts"}),e.jsxs("span",{className:"text-xs font-medium text-red-600 bg-red-50 px-2 py-1 rounded-full",children:[f.filter(s=>s.severity==="critical").length," ","Critical"]})]}),e.jsx("div",{className:"space-y-3",children:f.map(s=>e.jsxs("div",{className:a("flex items-start gap-4 p-4 rounded-lg",s.severity==="critical"?"bg-red-50 border border-red-100":"bg-amber-50 border border-amber-100"),children:[e.jsx("div",{className:a("w-10 h-10 rounded-lg flex items-center justify-center",s.severity==="critical"?"bg-red-100":"bg-amber-100"),children:e.jsx(s.icon,{className:a("w-5 h-5",s.severity==="critical"?"text-red-600":"text-amber-600")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:a("font-medium",s.severity==="critical"?"text-red-800":"text-amber-800"),children:s.type}),e.jsx("p",{className:a("text-sm mt-1",s.severity==="critical"?"text-red-600":"text-amber-600"),children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:a("px-3 py-1.5 text-sm font-medium rounded-lg",s.severity==="critical"?"bg-red-600 text-white hover:bg-red-700":"bg-amber-600 text-white hover:bg-amber-700"),children:s.severity==="critical"?"Investigate":"Start Audit"}),e.jsx("button",{className:"px-3 py-1.5 text-sm font-medium text-zinc-600 hover:bg-zinc-100 rounded-lg",children:"Dismiss"})]})]},s.id))})]})]})}export{X as default};
