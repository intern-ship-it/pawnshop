import{a as H,u as $,b as _,r,g as q,s as Q,k as S,j as e,i as j,T as X,d as N,X as G,m as A,C as W,n as Y,o as Z,S as L,e as b}from"./index-o28qtZ4E.js";import{a as z,b as B,c as F,f as ee}from"./formatters-BhAPqf4o.js";import{v as se}from"./validators-DzCKJgm6.js";import{P as ae}from"./PageWrapper-D4uzFYGf.js";import{m as l,B as i,a as te}from"./proxy-D6mGC7EI.js";import{C,I as ie}from"./Modal-7Sg338uS.js";import{B as u}from"./Badge-Br48OPWn.js";import{U as le,a as R}from"./user-x-DQUafW5_.js";import{C as T}from"./credit-card-CogcOOr3.js";import{A as y}from"./index-B9GDT2Wk.js";import{P as p}from"./plus-CQNf_PUI.js";import{P as ne}from"./phone-B5sqxf62.js";import{M as ce}from"./map-pin-CM4a5Gr_.js";import{S as re}from"./square-pen-DhoP9-Gi.js";import{F as oe}from"./funnel--zIacCUr.js";import{D as de}from"./download-Bqlh6cxb.js";function Ie(){const n=H(),c=$(),{customers:o}=_(s=>s.customers),[d,V]=r.useState(""),[m,w]=r.useState(""),[a,k]=r.useState(null),[E,I]=r.useState(!1),[x,M]=r.useState("all"),[g,U]=r.useState(!1);r.useEffect(()=>{const s=q(L.CUSTOMERS,[]);if(s.length===0){const t=[{id:"CUS001",name:"Ahmad bin Abdullah",icNumber:"880515145678",phone:"0123456789",whatsapp:"0123456789",email:"ahmad@email.com",address:"123, Jalan Merdeka, Taman Sentosa, 81200 Johor Bahru, Johor",dateOfBirth:"1988-05-15",gender:"male",occupation:"Engineer",icFrontImage:null,icBackImage:null,profilePhoto:null,activePledges:2,totalPledges:5,totalAmount:15e3,lastVisit:"2024-12-20",riskLevel:"low",status:"active",createdAt:"2024-01-15",updatedAt:"2024-12-20"},{id:"CUS002",name:"Siti Nurhaliza binti Mohd",icNumber:"920830108765",phone:"0198765432",whatsapp:"0198765432",email:"siti@email.com",address:"45, Lorong Damai, Kampung Baru, 50300 Kuala Lumpur",dateOfBirth:"1992-08-30",gender:"female",occupation:"Teacher",icFrontImage:null,icBackImage:null,profilePhoto:null,activePledges:1,totalPledges:3,totalAmount:8500,lastVisit:"2024-12-18",riskLevel:"low",status:"active",createdAt:"2024-03-20",updatedAt:"2024-12-18"},{id:"CUS003",name:"Raj Kumar a/l Subramaniam",icNumber:"750220145432",phone:"0167890123",whatsapp:"0167890123",email:"raj@email.com",address:"78, Jalan Harmoni, Taman Pelangi, 80400 Johor Bahru, Johor",dateOfBirth:"1975-02-20",gender:"male",occupation:"Business Owner",icFrontImage:null,icBackImage:null,profilePhoto:null,activePledges:0,totalPledges:8,totalAmount:45e3,lastVisit:"2024-12-10",riskLevel:"medium",status:"active",createdAt:"2023-06-10",updatedAt:"2024-12-10"},{id:"CUS004",name:"Lee Mei Ling",icNumber:"850712089012",phone:"0145678901",whatsapp:"0145678901",email:"meiling@email.com",address:"22, Jalan Kenanga, Taman Bunga, 14000 Bukit Mertajam, Penang",dateOfBirth:"1985-07-12",gender:"female",occupation:"Accountant",icFrontImage:null,icBackImage:null,profilePhoto:null,activePledges:3,totalPledges:6,totalAmount:22e3,lastVisit:"2024-12-22",riskLevel:"low",status:"active",createdAt:"2024-02-28",updatedAt:"2024-12-22"},{id:"CUS005",name:"Muhammad Faiz bin Ismail",icNumber:"950405067890",phone:"0112345678",whatsapp:"0112345678",email:"faiz@email.com",address:"99, Jalan Setia, Taman Impian, 40150 Shah Alam, Selangor",dateOfBirth:"1995-04-05",gender:"male",occupation:"Freelancer",icFrontImage:null,icBackImage:null,profilePhoto:null,activePledges:1,totalPledges:2,totalAmount:5500,lastVisit:"2024-12-15",riskLevel:"high",status:"active",createdAt:"2024-10-01",updatedAt:"2024-12-15"}];Q(L.CUSTOMERS,t),c(S(t))}else c(S(s))},[c]);const P=()=>{const s=m.replace(/[-\s]/g,"");if(!s){c(b({type:"warning",title:"IC Required",message:"Please enter an IC number to search"}));return}if(!se(s)){c(b({type:"error",title:"Invalid IC",message:"Please enter a valid 12-digit IC number"}));return}I(!0),setTimeout(()=>{const t=o.find(f=>f.icNumber.replace(/[-\s]/g,"")===s);k(t||"not_found"),I(!1),t&&c(b({type:"success",title:"Customer Found",message:`Found: ${t.name}`}))},500)},O=()=>{w(""),k(null)},v=o.filter(s=>{const t=d===""||s.name.toLowerCase().includes(d.toLowerCase())||s.icNumber.includes(d)||s.phone.includes(d),f=x==="all"||x==="active"&&s.activePledges>0||x==="inactive"&&s.activePledges===0||x==="high-risk"&&s.riskLevel==="high";return t&&f}),h={total:o.length,active:o.filter(s=>s.activePledges>0).length,inactive:o.filter(s=>s.activePledges===0).length,highRisk:o.filter(s=>s.riskLevel==="high").length},J={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},D={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},K={hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1},exit:{opacity:0,scale:.95}};return e.jsxs(ae,{title:"Customers",subtitle:"Manage customer records and IC lookup",actions:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{variant:"outline",leftIcon:de,children:"Export"}),e.jsx(i,{variant:"accent",leftIcon:p,onClick:()=>n("/customers/new"),children:"Add Customer"})]}),children:[e.jsx(l.div,{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",variants:J,initial:"hidden",animate:"visible",children:[{label:"Total Customers",value:h.total,icon:j,color:"zinc"},{label:"Active Pledges",value:h.active,icon:le,color:"emerald"},{label:"No Active Pledge",value:h.inactive,icon:R,color:"zinc"},{label:"High Risk",value:h.highRisk,icon:X,color:"red"}].map((s,t)=>e.jsx(l.div,{variants:D,children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:N("w-10 h-10 rounded-lg flex items-center justify-center",s.color==="emerald"&&"bg-emerald-100",s.color==="red"&&"bg-red-100",s.color==="zinc"&&"bg-zinc-100"),children:e.jsx(s.icon,{className:N("w-5 h-5",s.color==="emerald"&&"text-emerald-600",s.color==="red"&&"text-red-600",s.color==="zinc"&&"text-zinc-600")})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-zinc-800",children:s.value}),e.jsx("p",{className:"text-xs text-zinc-500",children:s.label})]})]})})},s.label))}),e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(C,{className:"mb-6",children:[e.jsx("div",{className:"p-5 border-b border-zinc-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-100 flex items-center justify-center",children:e.jsx(T,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-zinc-800",children:"IC Lookup"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Search customer by IC number"})]})]})}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ie,{placeholder:"Enter IC Number (e.g., 880515-14-5678)",value:m,onChange:s=>w(s.target.value),onKeyDown:s=>s.key==="Enter"&&P(),className:"pr-10"}),m&&e.jsx("button",{onClick:O,className:"absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600",children:e.jsx(G,{className:"w-4 h-4"})})]}),e.jsx(i,{variant:"primary",leftIcon:A,onClick:P,loading:E,children:"Fetch"})]}),e.jsx(y,{mode:"wait",children:a&&e.jsx(l.div,{variants:K,initial:"hidden",animate:"visible",exit:"exit",className:"mt-4",children:a==="not_found"?e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center flex-shrink-0",children:e.jsx(R,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-amber-800",children:"Customer Not Found"}),e.jsxs("p",{className:"text-sm text-amber-600 mt-1",children:["No customer with IC ",z(m)," exists in the system."]}),e.jsx(i,{variant:"accent",size:"sm",className:"mt-3",leftIcon:p,onClick:()=>n(`/customers/new?ic=${m.replace(/[-\s]/g,"")}`),children:"Create New Customer"})]})]})}):e.jsx("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-amber-500 to-amber-600 flex items-center justify-center text-white font-bold text-xl flex-shrink-0",children:a.name.charAt(0)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-zinc-800 text-lg",children:a.name}),e.jsx("p",{className:"text-sm text-zinc-500 font-mono",children:z(a.icNumber)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"success",children:"Verified"}),a.riskLevel==="high"&&e.jsx(u,{variant:"danger",children:"High Risk"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ne,{className:"w-4 h-4 text-zinc-400"}),e.jsx("span",{className:"text-zinc-600",children:B(a.phone)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(T,{className:"w-4 h-4 text-zinc-400"}),e.jsxs("span",{className:"text-zinc-600",children:[a.activePledges," Active Pledges"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(W,{className:"w-4 h-4 text-zinc-400"}),e.jsxs("span",{className:"text-zinc-600",children:["Last: ",F(a.lastVisit)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ce,{className:"w-4 h-4 text-zinc-400"}),e.jsx("span",{className:"text-zinc-600 truncate",children:a.address.split(",")[0]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx(i,{variant:"primary",size:"sm",leftIcon:te,onClick:()=>n(`/customers/${a.id}`),children:"View Profile"}),e.jsx(i,{variant:"accent",size:"sm",leftIcon:p,onClick:()=>{c(Y(a)),n("/pledges/new")},children:"New Pledge"}),e.jsx(i,{variant:"outline",size:"sm",leftIcon:re,onClick:()=>n(`/customers/${a.id}/edit`),children:"Edit"})]})]})]})})},a==="not_found"?"not-found":"found")})]})]})}),e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(C,{children:[e.jsxs("div",{className:"p-5 border-b border-zinc-100",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-zinc-100 flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-zinc-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-zinc-800",children:"All Customers"}),e.jsxs("p",{className:"text-sm text-zinc-500",children:[v.length," customers found"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-400"}),e.jsx("input",{type:"text",placeholder:"Search name, IC, phone...",value:d,onChange:s=>V(s.target.value),className:"w-64 pl-10 pr-4 py-2 bg-zinc-50 border border-zinc-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/30 focus:border-amber-500"})]}),e.jsx(i,{variant:g?"primary":"outline",size:"sm",leftIcon:oe,onClick:()=>U(!g),children:"Filters"})]})]}),e.jsx(y,{children:g&&e.jsx(l.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-zinc-100",children:[e.jsx("span",{className:"text-sm text-zinc-500",children:"Status:"}),["all","active","inactive","high-risk"].map(s=>e.jsx("button",{onClick:()=>M(s),className:N("px-3 py-1.5 text-sm rounded-lg transition-all",x===s?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"),children:s==="all"?"All":s==="active"?"Active Pledges":s==="inactive"?"No Pledges":"High Risk"},s))]})})})]}),e.jsx("div",{className:"divide-y divide-zinc-100",children:e.jsx(y,{children:v.length===0?e.jsxs(l.div,{initial:{opacity:0},animate:{opacity:1},className:"p-12 text-center",children:[e.jsx(j,{className:"w-12 h-12 text-zinc-300 mx-auto mb-3"}),e.jsx("p",{className:"text-zinc-500",children:"No customers found"}),e.jsx(i,{variant:"accent",size:"sm",className:"mt-4",leftIcon:p,onClick:()=>n("/customers/new"),children:"Add First Customer"})]}):v.map((s,t)=>e.jsx(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{delay:t*.03},onClick:()=>n(`/customers/${s.id}`),className:"p-4 hover:bg-zinc-50 cursor-pointer transition-colors group",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-zinc-200 to-zinc-300 flex items-center justify-center text-zinc-600 font-semibold text-lg flex-shrink-0 group-hover:from-amber-500 group-hover:to-amber-600 group-hover:text-white transition-all",children:s.name.charAt(0)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-zinc-800 truncate",children:s.name}),s.riskLevel==="high"&&e.jsx(u,{variant:"danger",size:"sm",children:"High Risk"}),s.riskLevel==="medium"&&e.jsx(u,{variant:"warning",size:"sm",children:"Medium"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[e.jsx("span",{className:"text-sm text-zinc-500 font-mono",children:z(s.icNumber)}),e.jsx("span",{className:"text-sm text-zinc-400",children:B(s.phone)})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-zinc-800",children:s.activePledges}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Active"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-zinc-800",children:ee(s.totalAmount)}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Total Value"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-zinc-600",children:F(s.lastVisit)}),e.jsx("p",{className:"text-xs text-zinc-500",children:"Last Visit"})]})]}),e.jsx(Z,{className:"w-5 h-5 text-zinc-300 group-hover:text-amber-500 transition-colors"})]})},s.id))})})]})})]})}export{Ie as default};
